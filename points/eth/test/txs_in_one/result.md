# 测试结果

## 测试多笔交易打包成一笔提交的gas消耗情况

测试目的：测试通过不同的调用方式，多次执行相同的逻辑，它们的gas消耗情况

- 调用方式1：只发送一笔交易，对应合约函数执行多次逻辑
- 调用方式2：发送多笔交易，对应合约函数执行一次逻辑

测试思路：见合约代码，值得一提的是，执行单次逻辑的函数只调用了一次，通过计算得到发送多笔交易的总消耗

测试代码："../contract/txs_in_one/data.sol"

测试链：[ropsten测试链](https://ropsten.etherscan.io)

测试参数：

1. 测试合约地址：0x9186e87b17552b65bc0c1ebbd5d0811c2128c620
2. 调用方式1产生的交易：0x6d8d059ed78dd5db39001d14aec833b350cdd8d3dc418d48ddf19e595ce9d1c5
    1. gas used: 267494
    2. 该笔交易对应的合约函数，执行了5次逻辑，即，输入的数组参数长度为5
3. 调用方式2产生的交易：0xafbc5d11f8fc7a027ecd4dcffc3d327ad96cda803ad176b3c971efd7783a53d0
    1. gas used: 69700
4. 调用方式1产生的另一笔交易：0xac3b53038190e206f3e26b4c2367f6d3bf847800d9452f135889615b04efdbde
    1. gas used: 169767
    2. 该笔交易对应的合约函数，执行了3次逻辑，即，输入的数组参数长度为3

计算：

1. 假设通过方式2也调用了5次，其gas消耗相比于方式1多：```69700*5-267494=81006```
2. 假设通过方式2也调用了3次，其gas消耗相比于方式1多：```69700*3-169767=39333```
3. 忽略函数执行消耗gas，计算结果忽略过长的位数，方式1在节省gas：
    1. 总计调用5次时：0.010125eth，约合32美元、203元人民币
        1. gas price: 2022.1.10-10.08，测试时，主网最新块上的交易的gas price——125 gwei
        2. eth价格：同上时间的主网eth价格——3152.15美元
        3. 美元与人民币兑换率：同上时间的兑换率——6.37（来自搜索引擎，搜索内容：美元与人民币的兑换率）
    2. 总计调用3次时：0.005eth，约合15.5美元、99元人民币

测试结论：

1. 调用方式1消耗gas更少
2. 根据2022.1.10-10.08时间，eth主网相关数据：
    1. 总计调用5次，方式1节省：0.010125eth，约合32美元、203元人民币
    2. 总计调用3次，方式1节省：0.005eth，约合15.5美元、99元人民币
