# tree

## 二叉搜索树(binary search tree)

一般来说，BST更适用于查询场景，插入和删除场景与堆结构更匹配

约定：如果一个BST全部叶子节点的高度差不大于1，我们说这个BST是**高度平衡**的，简称**平衡**的

向BST插入数据，可能破坏BST的平衡结构，极端情况下，BST将变成单链表、查询效率将退化为`O(n)`，所以对BST进行插入或删除操作时，应额外维护其平衡结构

最早被发明的平衡二叉搜索树为AVL树

## AVL树(Adelson-Velsky and Landis Tree)

AVL树是自平衡的二叉搜索树，AVL树通过左旋、右旋操作平衡树的高度

右旋：（左旋是右旋的镜像）

1. 根节点的左子节点成为新的根节点
2. 若新根节点存在右子节点，则将其重新挂载成原根节点的左子节点
3. 原根节点成为新根节点的右子节点

平衡规则：

约定：

1. h：节点高度，空节点高度为`-1`（方便计算），非空节点高度为**其左右子节点高度较大者+1**
2. b：平衡因子(balance factor)，仅定义于非空节点，计算规则为**节点的左子节点高度-节点的右子节点高度**

当**平衡因子的绝对值大于1**时，开始平衡：（以下使用**根节点(root node，简称n)**表示**最先触发平衡行为的节点**）

1. LL型：因为在根节点左子节点的左子节点挂载新的元素，导致破坏了原本的平衡结构
    1. 此时`b(n) > 1`且`b(n.l) > 0`
    2. 将根节点右旋一次即可恢复平衡结构
2. LR型：因为在根节点左子节点的右子节点挂载新的元素，导致破坏了原本的平衡结构
    1. 此时`b(n) > 1`且`b(n.l) < 0`
    2. 将根节点的左子节点左旋一次，再将根节点右旋一次即可恢复平衡结构
3. RR型：因为在根节点右子节点的右子节点挂载新的元素，导致破坏了原本的平衡结构
    1. 此时`b(n) < -1`且`b(n.r) < 0`
    2. 将根节点左旋一次即可恢复平衡结构
4. RL型：因为在根节点右子节点的左子节点挂载新的元素，导致破坏了原本的平衡结构
    1. 此时`b(n) < -1`且`b(n.r) > 0`
    2. 将根节点的右子节点右旋一次，再将根节点左旋一次即可恢复平衡结构

其中，LL型与RR型互为镜像结构、LR型与RL型互为镜像结构

理解：

1. 触发平衡行为时，为什么平衡因子只有上述四种情况？  
   说明：因为`|b| > 1`分为两种情况，即`b > 1`或`b < -1`，两种情况互为镜像，故此处仅以`b > 1`为例  
   左子节点高度比右子节点高度大，我们通过右旋来平衡 
   因为右旋行为会将可能存在的新根节点的右子节点，重新挂载成原根节点的左子节点；  
   该行为会将新根节点的右子节点高度+1（加了原根节点这一层），进而，该行为可能破坏新根节点的平衡结构，  
   故，在右旋操作前，我们首先保证新根节点，其平衡因子非负，即该节点左子树高度大于等于右子树高度，  
   至于实现方式，则是在新根节点平衡因子为负时，将其左旋一次

## 红黑树(red-black tree)(draft)

红黑树是一种自平衡二叉查找树，满足以下性质：
1. 每个节点都有且只有一个颜色：红色或黑色
2. 根节点是黑色
3. 每个叶子节点是黑色
4. 每个红色节点的子节点是黑色
5. 任选一个节点作为根节点，根节点到它的每个叶子节点的路径都包含相同数量的黑色节点
   1. 将红黑树的这种平衡称作**黑色完美平衡**

## B树(B-tree)(draft)

B树是一种自平衡的树，可以在对数时间内完成查找、顺序访问、插入以及删除操作

概括来说，B树是多叉查找树，与自平衡二叉查找树相比，B树适用于读写相对大的数据块的存储系统——例如磁盘，  
可以通过减少定位记录时所经历的中间过程，加快存取速度；常用于实现数据库与文件系统
